{% extends "base.html" %}

{% block title %}Attractions - Edinburgh Explorer{% endblock %}

{% block content %}
<section class="events-container">
  <h2>Top Attractions in Edinburgh</h2>

  <!-- Search & Filter Controls -->
  <div style="margin-bottom: 20px;">
    <input
      type="text"
      id="attractionSearch"
      placeholder="Search attractions..."
      style="padding:8px; width:100%; max-width:300px; margin-right:10px;"
    >
    <select
      id="categoryFilter"
      style="padding:8px;"
    >
      <option value="">All Categories</option>
      <option value="museum">Museum</option>
      <option value="historic">Historic</option>
      <option value="park">Park</option>
      <option value="art">Art</option>
      <option value="landmark">Landmark</option>
    </select>
  </div>

  <!-- Grid layout for attraction cards -->
  <div class="events-grid">
    {% for place in attractions %}
    <div class="event-card" data-category="{{ place.category }}" tabindex="0">
      <img
        src="{{ url_for('static', filename='images/' + (place.image if place.image else 'placeholder.jpg')) }}"
        alt="{{ place.name }} image"
      >
      <div class="event-text">
        <strong>{{ place.name }}</strong>
        <p>{{ place.description or 'No description available.' }}</p>
        <ul class="list-unstyled mb-0">
          <li><strong>Category:</strong> {{ place.category|capitalize or 'N/A' }}</li>
          <li><strong>Opening Times:</strong> {{ place.opening_times or 'N/A' }}</li>
          <li><strong>Address:</strong> {{ place.address or 'N/A' }}</li>
          <li><strong>Rating:</strong>  {{ place.rating or 'N/A' }}</li>
        </ul>
      </div>
    </div>
    {% endfor %}
  </div>

  <p class="events-note">More attractions coming soon! Explore the city and discover hidden gems.</p>
</section>

<!-- Search & Filter Script -->
<script>
/* Search & filter functionality inspired by W3Schools tutorials on HTML, JavaScript, and DOM manipulation
   Source: https://www.w3schools.com/howto/howto_js_filter_lists.asp */

function filterAttractions() {
  const searchValue = document.getElementById('attractionSearch').value.toLowerCase();
  const selectedCategory = document.getElementById('categoryFilter').value;
  const cards = document.querySelectorAll('.event-card');

  cards.forEach(card => {
    const text = card.innerText.toLowerCase();
    const category = card.getAttribute('data-category');
    const matchesSearch = text.includes(searchValue);
    const matchesCategory = !selectedCategory || category === selectedCategory;
    card.style.display = (matchesSearch && matchesCategory) ? '' : 'none';
  });
}

document.getElementById('attractionSearch').addEventListener('input', filterAttractions);
document.getElementById('categoryFilter').addEventListener('change', filterAttractions);
</script>
{% endblock %}
